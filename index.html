<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8">
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
	<script src="http://d3js.org/d3.v3.min.js"></script>
	<script src="http://d3js.org/topojson.v1.min.js"></script>
	<script src="javascripts/datamaps_quake.all.js"></script>
    <script src="javascripts/quakes_loop.js"></script>
    <script src="earthquake_2011_7_plus.js"></script>
	<title>Earthquake!</title>
</head>
<body>
 
<!-- ============================ Container Div for our World Map =============================
 -->
 
 <!-- 	<div id="container" style="position: relative; width: 500px; height: 300px;"></div>
 -->	
	<div id="map_quakes" style="position: relative; width: 500px; height: 300px;"></div>
 
	<script>
//========================== Map w/o quakes ==================================
 
   //  var map = new Datamap({
	  //   element: document.getElementById('container'),  
	  //   scope: 'usa',
	  //   fills: {
	  //   	defaultFill: 'rgba(200,148,210,0.9)'
	  //   }
  	// });
    
 
//========================== Map w/ quakes ===================================
 
    var earthquakeMap = new Datamap({
    element: $('#map_quakes')[0],
    scope: 'world',
    geographyConfig: {
        popupOnHover: false,
        highlightOnHover: false
    },
    fills: {
        'USA': '#1f77b4',
        'QUAKE': '#9467bd',
        'PRK': '#ff7f0e',
        'PRC': '#2ca02c',
        'IND': '#e377c2',
        'GBR': '#8c564b',
        'FRA': '#d62728',
        'PAK': '#7f7f7f',
        defaultFill: '#EDDC4E'
    },
    data: {
        'QUAKE': {fillKey: 'QUAKE'},
        'PRK': {fillKey: 'PRK'},
        'PRC': {fillKey: 'PRC'},
        'IND': {fillKey: 'IND'},
        'GBR': {fillKey: 'GBR'},
        'FRA': {fillKey: 'FRA'},
        'PAK': {fillKey: 'PAK'},
        'USA': {fillKey: 'USA'}
    }
});
 
     var quakes = [{
        location: eq_data.earthquakes[0].region,
        radius: eq_data.earthquakes[0].magnitude,
        magnitude: eq_data.earthquakes[0].magnitude,
        fillKey: 'QUAKE',
        timedate: eq_data.earthquakes[0].timedate,
        latitude: eq_data.earthquakes[0].lat,
        longitude: eq_data.earthquakes[0].lon
    }, {
        location: eq_data.earthquakes[1].region,
        radius: eq_data.earthquakes[1].magnitude,
        magnitude: eq_data.earthquakes[1].magnitude,
        fillKey: 'QUAKE',
        timedate: eq_data.earthquakes[1].timedate,
        latitude: eq_data.earthquakes[1].lat,
        longitude: eq_data.earthquakes[1].lon
    }
    ];
var eq_data = { count: '4',
  earthquakes: 
   [ { src: 'us',
       eqid: 'c0002aes',
       timedate: '2011-03-24 13:55:12',
       lat: '20.7047',
       lon: '99.9489',
       magnitude: '7.0',
       depth: '10.0',
       region: 'Mong Hpayak, Myanmar' },
     { src: 'us',
       eqid: 'c0001xig',
       timedate: '2011-03-11 06:25:51',
       lat: '38.0744',
       lon: '144.5589',
       magnitude: '7.1',
       depth: '26.5',
       region: 'off the east coast of Honshu, Japan' }
    ] }
    
 console.log(eq_data);
 
//-------------------------- draw bubbles for quakes -----------------------------------
 
earthquakeMap.bubbles(quakes, {
    popupTemplate: function (geo, data) { 
            return ['<div class="hoverinfo">' +  data.location,
            '<br/>Magnitude: ' +  data.magnitude,
            '<br/>Date & Time: ' +  data.timedate + '',
            '</div>'].join('');
    }
});
	</script>
 
</body>
</html>